(this["webpackJsonpfirestore-cms-iframe-example"]=this["webpackJsonpfirestore-cms-iframe-example"]||[]).push([[0],{21:function(e,n,t){"use strict";t.r(n);t(8);var i=t(0),o=t.n(i),l=t(5),a=t.n(l),r=t(2),c=t.n(r),d=t(6),s=t(4),p=t(3),b=t.n(p),u=t(1),g=t.n(u);b.a.prototype.getHTML=function(){return document.querySelector(".ql-editor").innerHTML},b.a.prototype.setHTML=function(e){document.querySelector(".ql-editor").innerHTML=e};var f={};var m=function(){var e=Object(i.useState)(!0),n=Object(s.a)(e,2),t=n[0],o=n[1],l=Object(i.useState)(),a=Object(s.a)(l,2),r=a[0],p=a[1];Object(i.useEffect)((function(){window.addEventListener("message",u,!1)}),[]);var u=function(e){e.origin.includes("login.bush_and_beyond")&&("initEditing"===e.data.actionType&&(console.log("initEditing!!!"),setInterval((function(){m()}),1500)),"startEdit"===e.data.actionType&&(q(),p(e.data.websiteContent)))};Object(i.useEffect)((function(){var e=document.head,n=document.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",e.appendChild(n),function(){e.removeChild(n)}}),[]);var m=function(){for(var e=0,n=Array.from(document.querySelectorAll(".cp-editable"));e<n.length;e++){var t=n[e];if(!t.querySelector(".cp-editable-btn")){console.log("Adding button");var i=document.createElement("div");i.classList.add("cp-editable-btn-wrapper");var o=document.createElement("div"),l=document.createElement("div");o.textContent="Edit",o.classList.add("cp-editable-btn"),l.classList.add("editor-wrapper");var a=document.createElement("div");a.textContent="Save",a.classList.add("cp-editable-save-btn");var r=document.createElement("div");r.textContent="Cancel",r.classList.add("cp-editable-cancel-btn"),a.onclick=function(e){y(e)},r.onclick=function(e){v(e)},o.onclick=function(e){x(e)},t.appendChild(l),i.appendChild(o),i.appendChild(a),i.appendChild(r),t.appendChild(i)}}},v=function(e){var n=e.target.closest(".cp-editable");n.classList.toggle("editing"),n.querySelector(".ql-toolbar").style.display="none",n.querySelector(".ql-container").style.display="none",n.innerHTML=f[g()(n)].getHTML(),m()},y=function(){var e=Object(d.a)(c.a.mark((function e(n){var t,i,o,l,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=n.target.closest(".cp-editable")).classList.toggle("editing"),i=f[g()(t)].getHTML(),console.log("got text: ",i),t.innerHTML=i,console.log(r),o=r,console.log("Loaded dbObj: ",o),l=t.id.split(/-|~/g),console.log("el.id: ",t.id),console.log("sections: ",l),a=h(t),console.log("Sending: ",l,a),window.parent.postMessage({actionType:"finishedEdit",sections:l,val:a},"*"),m();case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),h=function(e){return console.log("Extracting text from: ",e,e.innerHTML),e.innerHTML},L=[[{header:[2,!1]}],["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{align:[]}]],x=function(e){var n=e.target.closest(".cp-editable");n.classList.toggle("editing");var t=n.innerHTML.indexOf('<div class="editor-wrapper"'),i=n.innerHTML.substring(0,t);if(n.querySelector(".ql-toolbar"))console.log("Editor already exists!!!"),n.querySelector(".ql-toolbar").style.display="block",n.querySelector(".ql-container").style.display="block",n.innerHTML=n.innerHTML.replace(i,""),f[g()(n)].setHTML(i);else{n.innerHTML=n.innerHTML.replace(i,"");var o=new b.a(n.querySelector(".editor-wrapper"),{modules:{toolbar:L},theme:"snow",formats:["bold","header","italic","blockquote","indent","link","strike","script","underline","list","direction","align","image","video"]});o.setHTML(i),f[g()(n)]=o}n.querySelector(".cp-editable-cancel-btn").onclick=function(e){v(e)},n.querySelector(".cp-editable-save-btn").onclick=function(e){y(e)}},q=function(){t||o(!0),m(),document.head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn {\n                    display: block;\n                }\n\n                .ql-toolbar, \n                .editor-wrapper,\n                .ql-editor,\n                .ql-editor * {\n                    background-color: white!important;\n                    color: black!important;\n                }\n\n            </style>\n        ')};return""},v=function(){return o.a.createElement(m,null)};a.a.render(o.a.createElement(v,null),document.getElementById("root"))},7:function(e,n,t){e.exports=t(21)},8:function(e,n,t){}},[[7,1,2]]]);
//# sourceMappingURL=main.aceadf81.chunk.js.map