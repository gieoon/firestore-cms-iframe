(this["webpackJsonpfirestore-cms-iframe-example"]=this["webpackJsonpfirestore-cms-iframe-example"]||[]).push([[0],{21:function(e,n,t){"use strict";t.r(n);t(8);var i=t(0),a=t.n(i),r=t(5),o=t.n(r),l=t(2),c=t.n(l),d=t(6),p=t(4),s=t(3),b=t.n(s),u=t(1),g=t.n(u);b.a.prototype.getHTML=function(){return document.querySelector(".ql-editor").innerHTML},b.a.prototype.setHTML=function(e){document.querySelector(".ql-editor").innerHTML=e};var m={};var f=function(e){var n=e.allowedOrigin,t=Object(i.useState)(!0),a=Object(p.a)(t,2),r=a[0],o=a[1],l=Object(i.useState)(),s=Object(p.a)(l,2),u=(s[0],s[1]),f=Object(i.useState)(),v=Object(p.a)(f,2),y=(v[0],v[1]);Object(i.useEffect)((function(){window.addEventListener("message",h,!1)}),[]);var h=function(e){e.origin.includes(n)&&("initEditing"===e.data.actionType?setInterval((function(){x()}),1500):"startEdit"===e.data.actionType?(M(),u(e.data.websiteContent)):"updateElement"===e.data.actionType?document.getElementById(e.data.identifier).src=e.data.file.url:"updateArray"===e.data.actionType&&(console.log("RECEIVED UPDATING ARRAY: ",e.data),u(e.data.newWebsiteContent),window.location.reload()))};Object(i.useEffect)((function(){var e=document.head,n=document.createElement("link");return n.type="text/css",n.rel="stylesheet",n.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",e.appendChild(n),function(){e.removeChild(n)}}),[]);var x=function(){for(var e=0,n=Array.from(document.querySelectorAll(".cp-editable"));e<n.length;e++){if(!(u=n[e]).querySelector(".cp-editable-btn")){var t=document.createElement("div");t.classList.add("cp-editable-btn-wrapper");var i=document.createElement("div"),a=document.createElement("div");i.textContent="Edit",i.classList.add("cp-editable-btn"),a.classList.add("editor-wrapper");var r=document.createElement("div");r.textContent="Save",r.classList.add("cp-editable-save-btn");var o=document.createElement("div");o.textContent="Cancel",o.classList.add("cp-editable-cancel-btn"),r.onclick=function(e){k(e)},o.onclick=function(e){L(e)},i.onclick=function(e){S(e)},u.appendChild(a),t.appendChild(i),t.appendChild(r),t.appendChild(o),u.appendChild(t)}}for(var l=0,c=Array.from(document.querySelectorAll(".cp-editable-img"));l<c.length;l++){if(!(u=c[l]).parentElement.querySelector(".cp-editable-img-btn")){u.parentElement.style.position="relative";var d=document.createElement("div");d.classList.add("cp-editable-img-wrapper");var p=document.createElement("div");p.textContent="Change Image",p.classList.add("cp-editable-img-btn"),p.onclick=function(e){e.preventDefault(),e.stopPropagation(),q(e)},d.appendChild(p),u.parentElement.insertBefore(d,u.nextSibling)}}for(var s=0,b=Array.from(document.querySelectorAll(".cp-editable-array"));s<b.length;s++){var u;if(!(u=b[s]).querySelector(".cp-editable-array-plus")){for(var g=Array.from(u.querySelectorAll(":scope > div")),m=0;m<g.length;m++){var f=document.createElement("div");f.classList.add("cp-editable-array-minus-wrapper");var v=document.createElement("div");v.textContent="-",v.classList.add("cp-editable-array-minus"),v.id=m,f.style.position="relative",f.appendChild(v),g[m].appendChild(f),v.onclick=function(e){var n=e.target.closest(".cp-editable-array");window.parent.postMessage({actionType:"removeFromArray",sections:E(n.id),identifier:n.id,index:e.target.id},"*")}}u.style.position="relative";var y=document.createElement("div");y.classList.add("cp-editable-array-plus-wrapper");var h=document.createElement("div");h.textContent="+",h.classList.add("cp-editable-array-plus"),y.appendChild(h),u.appendChild(y),h.onclick=function(e){var n=e.target.parentElement.parentElement,t=w(n);window.parent.postMessage({actionType:"addToArray",sections:E(n.id),identifier:n.id,obj:t},"*")}}}},w=function(e){var n=[];console.log("parentelements: ",e);for(var t=0,i=Array.from(e.firstChild.querySelectorAll("[id]"));t<i.length;t++){var a=i[t];if(!a.classList.contains("cp-editable-array-minus")){var r=a.id.match(/[a-zA-Z0-9]+$/);console.log(r,r[0]),n.push({type:a.tagName.toLowerCase(),value:r[0]})}}return n},L=function(e){var n=e.target.closest(".cp-editable");n.classList.toggle("editing"),n.querySelector(".ql-toolbar").style.display="none",n.querySelector(".ql-container").style.display="none",n.innerHTML=m[g()(n)].getHTML(),x()},k=function(){var e=Object(d.a)(c.a.mark((function e(n){var t,i,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=n.target.closest(".cp-editable")).classList.toggle("editing"),i=m[g()(t)].getHTML(),t.innerHTML=i,a=t.id.split(/-|~/g),r=T(t),window.parent.postMessage({actionType:"finishedEdit",sections:a,val:r},"*"),x();case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(e){return e.split(/-|~/g)},q=function(e){var n=e.target,t=n.parentElement.previousElementSibling;console.log("variables: ",n,t,t.id),t.classList.toggle("editing"),y(t.id),window.parent.postMessage({actionType:"editFile",sections:E(t.id),identifier:t.id},"*")},T=function(e){return e.innerHTML},C=[[{header:[2,!1]}],["bold","italic","underline","strike"],["blockquote","link"],[{list:"ordered"},{list:"bullet"}],[{align:[]}]],S=function(e){var n=e.target.closest(".cp-editable");n.classList.toggle("editing");var t=n.innerHTML.indexOf('<div class="editor-wrapper"'),i=n.innerHTML.substring(0,t);if(n.querySelector(".ql-toolbar"))n.querySelector(".ql-toolbar").style.display="block",n.querySelector(".ql-container").style.display="block",n.innerHTML=n.innerHTML.replace(i,""),m[g()(n)].setHTML(i);else{n.innerHTML=n.innerHTML.replace(i,"");var a=new b.a(n.querySelector(".editor-wrapper"),{modules:{toolbar:C},theme:"snow",formats:["bold","header","italic","blockquote","indent","link","strike","script","underline","list","direction","align","image","video"]});a.setHTML(i),m[g()(n)]=a}n.querySelector(".cp-editable-cancel-btn").onclick=function(e){L(e)},n.querySelector(".cp-editable-save-btn").onclick=function(e){k(e)}},M=function(){r||o(!0),x(),document.head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover,\n                .cp-editable-img-cancel-btn:hover,\n                .cp-editable-img-save-btn:hover,\n                .cp-editable-img-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn,\n                .cp-editable-img.editing .cp-editable-img-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn,\n                .cp-editable-img .cp-editable-img-cancel-btn,\n                .cp-editable-img .cp-editable-img-save-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn,\n                .cp-editable-img-btn.editing .cp-editable-img-cancel-btn,\n                .cp-editable-img-btn.editing .cp-editable-img-save-btn {\n                    display: block;\n                }\n\n                .ql-toolbar, \n                .editor-wrapper,\n                .ql-editor,\n                .ql-editor * {\n                    background-color: white!important;\n                    color: black!important;\n                    line-height: normal!important;\n                    text-align: initial!important;\n                }\n\n                .cp-editable-img-btn {\n                    position: relative;\n                    border: 2px solid black;\n                    background-color: black;\n                    color: white;\n                    white-space: nowrap;\n                    padding: 2px 4px;\n                    width: fit-content;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-img-wrapper {\n                    position: absolute;\n                    z-index: 1;\n                    right: 0;\n                    bottom: 5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n\n                .cp-editable-array-minus-wrapper {\n                    position: relative;\n                }\n                .cp-editable-array-minus {\n                    position: absolute;\n                    bottom: 5px;\n                    right: 5px;\n                    /*top: 50%;*/\n                    /*transform: translateY(-50%);*/\n                    border: 1px solid rgba(150,150,150,0.5);\n                    border-radius: 4px;\n                    font-size: 20px;\n                    background-color: black;\n                    font-weight: 800;\n                    line-height: 20px;\n                    padding: 5px 10px;\n                    color: white;\n                    cursor: pointer;\n                }\n                .cp-editable-array-plus-wrapper {\n                    position: absolute;\n                    right: 10px;\n                    bottom: 0px;\n                }\n                .cp-editable-array-plus {\n                    position: absolute;\n                    bottom: -35px;\n                    right: 0px;\n                    background-color: black;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    border-radius: 4px;\n                    font-size: 25px;\n                    color: white;\n                    font-weight: 800;\n                    line-height: 20px;\n                    padding: 5px 10px;\n                    cursor: pointer;\n\n                }\n                .cp-editable-array-plus:hover ,\n                .cp-editable-array-minus:hover {\n                    opacity: .75;\n                }\n            </style>\n        ')};return""},v=function(){return a.a.createElement(f,{allowedOrigin:"<example-domain.com>"})};o.a.render(a.a.createElement(v,null),document.getElementById("root"))},7:function(e,n,t){e.exports=t(21)},8:function(e,n,t){}},[[7,1,2]]]);
//# sourceMappingURL=main.10e680fb.chunk.js.map