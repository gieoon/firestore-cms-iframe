(this["webpackJsonpfirestore-cms-iframe-example"]=this["webpackJsonpfirestore-cms-iframe-example"]||[]).push([[0],{19:function(e,t,n){"use strict";n.r(t);n(5);var i=n(0),a=n.n(i),r=n(3),o=n.n(r),l=n(2),c=n.n(l),d=n(1),p=n.n(d);c.a.prototype.getHTML=function(){return document.querySelector(".ql-editor").innerHTML},c.a.prototype.setHTML=function(e){document.querySelector(".ql-editor").innerHTML=e};var s={};var b=function(e){var t=e.allowedOrigin,n=e.templates,a=Object(i.useState)(!0),r=a[0],o=a[1],l=Object(i.useState)(),d=(l[0],l[1]),b=Object(i.useState)()[1];Object(i.useEffect)((function(){window.addEventListener("message",u,!1),window.onclick=function(e){console.log("something was clicked: ",e.target),Boolean(e.target.closest(".cp-editable.editing"))&&(console.log("BLOCKING"),e.preventDefault(),e.stopPropagation())}}),[]);var u=function(e){e.origin.includes(t)&&("initEditing"===e.data.actionType?setInterval((function(){g()}),1500):"startEdit"===e.data.actionType?(L(),d(e.data.websiteContent)):"updateElement"===e.data.actionType?document.getElementById(e.data.identifier).src=e.data.file.url:"updateArray"===e.data.actionType&&(console.log("RECEIVED UPDATING ARRAY: ",e.data),d(e.data.newWebsiteContent),window.location.reload()))};Object(i.useEffect)((function(){var e=document.head,t=document.createElement("link");return t.type="text/css",t.rel="stylesheet",t.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",e.appendChild(t),function(){e.removeChild(t)}}),[]);var g=function(){for(var e=0,t=Array.from(document.querySelectorAll(".cp-editable"));e<t.length;e++){if(!(u=t[e]).querySelector(".cp-editable-btn")){var n=document.createElement("div");n.classList.add("cp-editable-btn-wrapper");var i=document.createElement("div"),a=document.createElement("div");i.textContent="Edit",i.classList.add("cp-editable-btn"),a.classList.add("editor-wrapper");var r=document.createElement("div");r.textContent="Save",r.classList.add("cp-editable-save-btn");var o=document.createElement("div");o.textContent="Cancel",o.classList.add("cp-editable-cancel-btn"),r.onclick=function(e){f(e)},o.onclick=function(e){v(e)},i.onclick=function(e){k(e)},u.appendChild(a),n.appendChild(i),n.appendChild(r),n.appendChild(o),u.appendChild(n)}}for(var l=0,c=Array.from(document.querySelectorAll(".cp-editable-img"));l<c.length;l++){if(!(u=c[l]).parentElement.querySelector(".cp-editable-img-btn")){u.parentElement.style.position="relative";var d=document.createElement("div");d.classList.add("cp-editable-img-wrapper");var p=document.createElement("div");p.textContent="Change Image",p.classList.add("cp-editable-img-btn"),p.onclick=function(e){e.preventDefault(),e.stopPropagation(),h(e)},d.appendChild(p),u.parentElement.insertBefore(d,u.nextSibling)}}for(var s=0,b=Array.from(document.querySelectorAll(".cp-editable-array"));s<b.length;s++){var u;if(!(u=b[s]).querySelector(".cp-editable-array-minus-wrapper")){for(var g=Array.from(u.querySelectorAll(":scope > *:not(.cp-editable-array-plus-wrapper)")),x=0;x<g.length;x++){var w=document.createElement("div");w.classList.add("cp-editable-array-minus-wrapper");var L=document.createElement("div");L.textContent="X",L.classList.add("cp-editable-array-minus"),L.id=x,w.style.position="relative",w.appendChild(L),g[x].appendChild(w),L.onclick=function(e){var t=e.target.closest(".cp-editable-array");window.parent.postMessage({actionType:"removeFromArray",sections:y(t.id),identifier:t.id,index:e.target.id},"*")}}u.style.position="relative"}if(!u.querySelector(".cp-editable-array-plus")){var E=document.createElement("div");E.classList.add("cp-editable-array-plus-wrapper");var q=document.createElement("div");q.textContent="+",q.classList.add("cp-editable-array-plus"),E.appendChild(q),u.appendChild(E),q.onclick=function(e){var t=e.target.parentElement,n=m(t);window.parent.postMessage({actionType:"addToArray",sections:y(t.closest(".cp-editable-array").id),identifier:t.closest(".cp-editable-array").id,obj:n},"*")}}}},m=function(e){console.log("USING TEMPLATE] ",e.closest(".cp-editable-array").id);var t=e.closest(".cp-editable-array").id.match(/[a-zA-Z0-9_]+$/);return n[t[0]]},v=function(e){e.preventDefault(),e.stopPropagation();var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),t.querySelector(".ql-toolbar").style.display="none",t.querySelector(".ql-container").style.display="none",t.innerHTML=s[p()(t)].getHTML(),g()},f=function(e){try{e.preventDefault(),e.stopPropagation();var t=e.target.closest(".cp-editable");t.classList.toggle("editing");var n=s[p()(t)].getHTML();t.innerHTML=n;var i=t.id.split(/-|~/g),a=x(t);return window.parent.postMessage({actionType:"finishedEdit",sections:i,val:a},"*"),g(),Promise.resolve()}catch(e){return Promise.reject(e)}},y=function(e){return e.split(/-|~/g)},h=function(e){var t=e.target,n=t.parentElement.previousElementSibling;console.log("variables: ",t,n,n.id),n.classList.toggle("editing"),b(n.id),window.parent.postMessage({actionType:"editFile",sections:y(n.id),identifier:n.id},"*")},x=function(e){return e.innerHTML},w=[[{header:[2,!1]}],["bold","italic","underline","strike"],["blockquote","link"],[{list:"ordered"},{list:"bullet"}],[{align:[]}]],k=function(e){var t=e.target;e.preventDefault(),e.stopPropagation();var n=t.closest(".cp-editable");n.classList.toggle("editing");var i=n.innerHTML.indexOf('<div class="editor-wrapper"'),a=n.innerHTML.substring(0,i);if(n.querySelector(".ql-toolbar"))n.querySelector(".ql-toolbar").style.display="block",n.querySelector(".ql-container").style.display="block",n.innerHTML=n.innerHTML.replace(a,""),s[p()(n)].setHTML(a);else{n.innerHTML=n.innerHTML.replace(a,"");var r=new c.a(n.querySelector(".editor-wrapper"),{modules:{toolbar:w},theme:"snow",formats:["bold","header","italic","blockquote","indent","link","strike","script","underline","list","direction","align","image","video"]});r.setHTML(a),s[p()(n)]=r}n.querySelector(".cp-editable-cancel-btn").onclick=function(e){v(e)},n.querySelector(".cp-editable-save-btn").onclick=function(e){f(e)}},L=function(){r||o(!0),g(),document.head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;;\n                }\n                .cp-editable.editing {\n                    pointer-events: all!important\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    pointer-events: all;\n                    top: 5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover,\n                .cp-editable-img-cancel-btn:hover,\n                .cp-editable-img-save-btn:hover,\n                .cp-editable-img-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn,\n                .cp-editable-img.editing .cp-editable-img-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn,\n                .cp-editable-img .cp-editable-img-cancel-btn,\n                .cp-editable-img .cp-editable-img-save-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn,\n                .cp-editable-img-btn.editing .cp-editable-img-cancel-btn,\n                .cp-editable-img-btn.editing .cp-editable-img-save-btn {\n                    display: block;\n                }\n\n                .ql-toolbar, \n                .editor-wrapper,\n                .ql-editor,\n                .ql-editor * {\n                    background-color: white!important;\n                    color: black!important;\n                    line-height: normal!important;\n                    text-align: initial!important;\n                }\n\n                .cp-editable-img-btn {\n                    position: relative;\n                    border: 2px solid black;\n                    background-color: black;\n                    color: white;\n                    white-space: nowrap;\n                    padding: 2px 4px;\n                    width: fit-content;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-img-wrapper {\n                    position: absolute;\n                    z-index: 1;\n                    right: 0;\n                    bottom: 5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n\n                .cp-editable-array-minus-wrapper {\n                    position: relative;\n                }\n                .cp-editable-array-minus {\n                    position: absolute;\n                    bottom: 5px;\n                    right: 5px;\n                    /*top: 50%;*/\n                    /*transform: translateY(-50%);*/\n                    border: 1px solid rgba(150,150,150,0.5);\n                    border-radius: 4px;\n                    font-size: 20px;\n                    background-color: black;\n                    font-weight: 800;\n                    line-height: 20px;\n                    padding: 5px 10px;\n                    color: white;\n                    cursor: pointer;\n                }\n                .cp-editable-array-plus-wrapper {\n                    position: absolute;\n                    right: 10px;\n                    bottom: 0px;\n                }\n                .cp-editable-array-plus {\n                    position: absolute;\n                    bottom: -35px;\n                    right: 0px;\n                    background-color: black;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    border-radius: 4px;\n                    font-size: 25px;\n                    color: white;\n                    font-weight: 800;\n                    line-height: 20px;\n                    padding: 5px 10px;\n                    cursor: pointer;\n\n                }\n                .cp-editable-array-plus:hover ,\n                .cp-editable-array-minus:hover {\n                    opacity: .75;\n                }\n            </style>\n        ')};return""},u=function(){return a.a.createElement(b,{allowedOrigin:"<example-domain.com>",templates:{}})};o.a.render(a.a.createElement(u,null),document.getElementById("root"))},4:function(e,t,n){e.exports=n(19)},5:function(e,t,n){}},[[4,1,2]]]);
//# sourceMappingURL=main.f59540fb.chunk.js.map